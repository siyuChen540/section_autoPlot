# 科学考察航测站点自动绘图程序

本程序基于预定义的Excel模板，自动生成科学考察航测站点图。通过读取Excel文件中的站点信息，程序可以在指定的经纬度范围内，使用Python的Cartopy和Matplotlib库绘制包含地形、水深、行政边界等元素的站点分布图。

## 运行环境

- Python 3.8+
- 依赖包：numpy, pandas, matplotlib, cartopy, xarray

## 使用方法

1. 准备Excel模板文件，文件名为`station_info.xlsx`，放置在程序所在目录下。Excel文件应包含以下列：

| 站点名称 | 经度(度) | 经度(分) | 纬度(度) | 纬度(分) | 站点类型 | 站点编号 | 站点状态 |
|---------|----------|----------|----------|----------|----------|----------|----------|

2. 安装依赖包
```bash 
pip install numpy pandas matplotlib cartopy xarray
```

3. 运行程序
```bash
python main.py
```

4. 程序将读取`station_info.xlsx`文件，并在经纬度范围为\[105°E-125°E, 5°N-25°N\]的南海区域内绘制站点分布图。生成的图片文件名为`marineRsearch.png`，存储在程序所在目录下。

## 程序结构

- `main.py`: 主程序文件，负责数据读取、图形绘制和文件输出。
- `param.py`: 参数文件，定义了程序使用的文件路径、Shapefile数据和深度数据信息。
- `utils.py`: 工具函数文件，包括自定义colormap、山体阴影计算、陆地掩膜生成等函数。

## 主要功能

1. 读取站点Excel文件，并将经纬度信息转换为十进制格式。
2. 使用Cartopy库绘制南海区域的地图，包括海岸线、行政边界、断层带和河流等地理信息。 
3. 加载GEBCO 2022全球地形数据，并使用自定义colormap绘制水深信息。
4. 计算山体阴影，并将其叠加在水深图层之上，以突出地形特征。
5. 使用Matplotlib的散点图绘制站点位置，并使用legend标注站点名称。
6. 在图片周围添加经纬度网格，便于定位站点。
7. 将生成的图片保存为高分辨率（1200 DPI）的PNG格式文件。

## 注意事项

1. Excel模板文件的格式和列名需与程序预期一致，否则可能导致读取错误。
2. Shapefile和全球地形数据需提前准备好，并将路径正确设置在`param.py`文件中。
3. 程序生成的图片文件可能较大，请确保磁盘空间充足。
4. 如需调整图片的样式和布局，可以修改`main.py`中的相关参数，如字体大小、散点大小、配色方案等。

## 示例结果

![marineRsearch.png](marineRsearch.png)
